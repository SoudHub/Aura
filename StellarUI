--// StellarUI - Client Safe Version
--// Compatível com executores
--// Estilo StellarUI clássico

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

local LocalPlayer = Players.LocalPlayer

-- CLEANUP
pcall(function()
    CoreGui:FindFirstChild("StellarUI"):Destroy()
end)

-- MAIN GUI
local Gui = Instance.new("ScreenGui")
Gui.Name = "StellarUI"
Gui.ResetOnSpawn = false
Gui.Parent = CoreGui

-- MAIN FRAME
local Main = Instance.new("Frame", Gui)
Main.Size = UDim2.fromScale(0.45, 0.55)
Main.Position = UDim2.fromScale(0.5, 0.5)
Main.AnchorPoint = Vector2.new(0.5, 0.5)
Main.BackgroundColor3 = Color3.fromRGB(20,20,20)
Main.BorderSizePixel = 0

Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 10)

-- DRAG
do
    local dragging, dragInput, startPos, startInput
    Main.InputBegan:Connect(function(i)
        if i.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            startInput = i.Position
            startPos = Main.Position
        end
    end)
    Main.InputChanged:Connect(function(i)
        if i.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = i
        end
    end)
    UIS.InputChanged:Connect(function(i)
        if i == dragInput and dragging then
            local delta = i.Position - startInput
            Main.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    UIS.InputEnded:Connect(function(i)
        if i.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
end

-- TAB HOLDER
local Tabs = Instance.new("Frame", Main)
Tabs.Size = UDim2.new(0, 130, 1, 0)
Tabs.BackgroundColor3 = Color3.fromRGB(25,25,25)
Tabs.BorderSizePixel = 0

Instance.new("UICorner", Tabs).CornerRadius = UDim.new(0,10)

local TabLayout = Instance.new("UIListLayout", Tabs)
TabLayout.Padding = UDim.new(0,6)

-- CONTENT
local Pages = Instance.new("Frame", Main)
Pages.Position = UDim2.new(0, 140, 0, 10)
Pages.Size = UDim2.new(1, -150, 1, -20)
Pages.BackgroundTransparency = 1

-- LIB
local Library = {}
local CurrentPage = nil

function Library:AddTab(name)
    local TabButton = Instance.new("TextButton", Tabs)
    TabButton.Size = UDim2.new(1, -10, 0, 32)
    TabButton.Text = name
    TabButton.Font = Enum.Font.GothamBold
    TabButton.TextSize = 13
    TabButton.TextColor3 = Color3.new(1,1,1)
    TabButton.BackgroundColor3 = Color3.fromRGB(35,35,35)
    TabButton.BorderSizePixel = 0
    Instance.new("UICorner", TabButton).CornerRadius = UDim.new(0,6)

    local Page = Instance.new("ScrollingFrame", Pages)
    Page.Size = UDim2.fromScale(1,1)
    Page.CanvasSize = UDim2.new(0,0,0,0)
    Page.ScrollBarImageTransparency = 1
    Page.Visible = false

    local Layout = Instance.new("UIListLayout", Page)
    Layout.Padding = UDim.new(0,8)

    Layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        Page.CanvasSize = UDim2.new(0,0,0,Layout.AbsoluteContentSize.Y + 10)
    end)

    TabButton.MouseButton1Click:Connect(function()
        if CurrentPage then
            CurrentPage.Visible = false
        end
        Page.Visible = true
        CurrentPage = Page
    end)

    if not CurrentPage then
        Page.Visible = true
        CurrentPage = Page
    end

    local Tab = {}

    function Tab:AddSection(title)
        local Section = Instance.new("Frame", Page)
        Section.Size = UDim2.new(1, -10, 0, 36)
        Section.BackgroundColor3 = Color3.fromRGB(30,30,30)
        Section.BorderSizePixel = 0
        Instance.new("UICorner", Section).CornerRadius = UDim.new(0,6)

        local Label = Instance.new("TextLabel", Section)
        Label.Size = UDim2.new(1, -10, 1, 0)
        Label.Position = UDim2.new(0, 10, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = title
        Label.Font = Enum.Font.GothamBold
        Label.TextSize = 14
        Label.TextColor3 = Color3.new(1,1,1)
        Label.TextXAlignment = Left

        local SectionAPI = {}

        function SectionAPI:AddToggle(data)
            local Toggle = Instance.new("TextButton", Page)
            Toggle.Size = UDim2.new(1, -10, 0, 30)
            Toggle.BackgroundColor3 = Color3.fromRGB(35,35,35)
            Toggle.Text = data.Name .. ": OFF"
            Toggle.Font = Enum.Font.Gotham
            Toggle.TextSize = 13
            Toggle.TextColor3 = Color3.new(1,1,1)
            Toggle.BorderSizePixel = 0
            Instance.new("UICorner", Toggle).CornerRadius = UDim.new(0,6)

            local state = data.Default or false
            Toggle.Text = data.Name .. ": " .. (state and "ON" or "OFF")

            Toggle.MouseButton1Click:Connect(function()
                state = not state
                Toggle.Text = data.Name .. ": " .. (state and "ON" or "OFF")
                pcall(data.Callback, state)
            end)
        end

        function SectionAPI:AddButton(data)
            local Btn = Instance.new("TextButton", Page)
            Btn.Size = UDim2.new(1, -10, 0, 30)
            Btn.Text = data.Name
            Btn.Font = Enum.Font.GothamBold
            Btn.TextSize = 13
            Btn.TextColor3 = Color3.new(1,1,1)
            Btn.BackgroundColor3 = Color3.fromRGB(40,40,40)
            Btn.BorderSizePixel = 0
            Instance.new("UICorner", Btn).CornerRadius = UDim.new(0,6)

            Btn.MouseButton1Click:Connect(function()
                pcall(data.Callback)
            end)
        end

        return SectionAPI
    end

    return Tab
end

return Library
